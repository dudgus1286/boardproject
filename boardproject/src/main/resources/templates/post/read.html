<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/layout}">
  <th:block layout:fragment="css">
    <link rel="stylesheet" th:href="@{/css/searchFormDiv.css}">
    <link rel="stylesheet" th:href="@{/css/individualPost.css}">
    <link rel="stylesheet" th:href="@{/css/modal.css}">
  </th:block>
  <div layout:fragment="mainHeader" class="mainHeader">
    <!-- 검색폼 -->
    <div class="searchFormDiv">
      <h2>검색하기</h2>
      <button class="toggle searchtoggle textBold">검색창 닫기</button>
      <form th:action="@{list}" id="searchForm">
        <div class="searchTypeKeyword">
          <select name="type" id="type" class="searchType">
            <!-- 글 검색 -->
            <option value="t">텍스트</option>
            <option value="user">작성자</option>
            <option value="tag">태그</option>
          </select>
          <input type="text" name="keyword" id="keyword" placeholder="키워드를 입력하시오" class="searchKeyword" />
        </div>
        <div class="searchBtnContainer">
          <div class="searchImageCheckbox">
            <label for="image">이미지 여부</label>
            <input type="checkbox" name="image" id="image" value="true" />
          </div>
          <input type="hidden" name="page" value="1">
          <button type="submit" class="searchBtn">검색</button>
        </div>
      </form>
    </div>
    <!-- 검색폼이 있을경우 펼침 버튼 -->
    <button class="toggle searchtoggle textBold hidden">검색창 열기</button>

    <!-- 검색폼 여부와 상관없이 상단 여백 -->
    <div class="timelineHeader"></div>
  </div>

  <div layout:fragment="mainContainer" class="mainContainer searchFormMargin">
        <!-- 메인홈 타임라인 -->
        <div class="timelineContainer postContainer">
          <div class="individualPost" th:each="post : ${result.dtoList}">
            <div class="prevPost" th:if="${post.prevPostList}" th:each="prevPost : ${post.prevPostList}">
              <p>
                <span class="createDate" th:text="${#temporals.format(prevPost.createdAt, 'yyyy-MM-dd HH:mm')}">(yyyy-MM-dd)</span>
                <a href="이전글작성자" class="prevNickname textBold" th:text="${prevPost.writerNickname}">작성자</a>:
                <a href="이전글개별글" class="prevText" th:text="${prevPost.text}">
                  이전 글 내용
                </a>
              </p>
            </div>

            <div class="postInfo">
              <div class="postCreateDate createDate">
                작성일:
                <span th:text="${#temporals.format(post.post.createdAt, 'yyyy-MM-dd HH:mm')}">yyyy-MM-dd</span>
                <span th:if="${#temporals.format(post.post.updatedAt,'yyyy-MM-dd HH:mm') != #temporals.format(post.post.createdAt,'yyyy-MM-dd HH:mm')}">(수정됨)</span>
              </div>
              <div class="writer">
                <div class="writerImg">
                  <a href="게시글작성자">
                  <img src="http://via.placeholder.com/50.jpg" alt="" />
                  </a>
                </div>
                <span class="writerNickname textBold">
                  <a href="게시글작성자" th:text="${post.post.writerNickname}">
                    작성자닉네임
                  </a>
                </span>
              </div>
            </div>

            <div class="post">
              <div class="postText">
                <p>
                  <a href="개별글페이지" th:text="${post.post.text}">
                    게시글 텍스트
                  </a>
                </p>
              </div>
              <div class="postImages" th:if="${post.post.imageList}">
                <div class="postImage" th:each="image : ${post.post.imageList}">
                  <img src="http://via.placeholder.com/200.jpg" alt="" />
                </div>
              </div>
            </div>

            <div class="nextPosts" th:if="${post.replyList}">
              <div class="nextPostsCount">
                <p class="textBold">
                  덧글 개수:
                  <span th:text="${post.replyList.size()}">(0)</span>
                </p>
              </div>
              <div class="nextPostsList hidden">
                <div class="nextPost" th:each="reply : ${post.replyList}">
                  <p>
                    <span class="createDate" th:text="${#temporals.format(reply.createdAt,'yyyy-MM-dd HH:mm')}">(yyyy-MM-dd)</span>
                    <a href="댓글작성자" class="nextNickname textBold" th:text="${reply.writerNickname}">작성자</a>:
                    <a href="댓글개별글" class="nextText" th:text="${reply.text}">댓글 내용</a>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 이미지 모달 -->
        <div class="modal hidden">
            <div class="modalBody">
              <div class="modalBodyInfo">
                <p>작성자: <span class="writerNickname textBold">김모 씨</span></p>
                <p>원본글 링크</p>
              </div>
              <div class="modalBodyImage">
                <img src="https://picsum.photos/id/237/2000/2000" alt="" onclick="window.open(this.src)" />
              </div>
              <div class="modalBodyClose">
                <button type="button" class="modalBodyCloseBtn">닫기</button>
              </div>
            </div>
        </div>
  </div>

  <th:block layout:fragment="javascript">
    <script th:src="@{/js/toggle.js}"></script>
    <script th:src="@{/js/postContainerEvent.js}"></script>
    <!-- <script th:src="@{/js/toggleSFormless.js}"></script> -->
  </th:block>
</html>